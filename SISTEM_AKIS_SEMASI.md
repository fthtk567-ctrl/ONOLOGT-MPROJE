# ðŸ”„ ONLOG Ã–DEME SÄ°STEMÄ° AKIÅž ÅžEMASI

## ðŸ“Š Tam SipariÅŸ ve Ã–deme AkÄ±ÅŸÄ±

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        1. SÄ°PARÄ°Åž OLUÅžTURMA AÅžAMASI                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Merchant App                     DÄ±ÅŸ API                    Supabase DB
        â”‚                              â”‚                            â”‚
        â”‚  Kurye Ã‡aÄŸÄ±r                â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  INSERT INTO orders        â”‚
        â”‚                              â”‚  status='WAITING...'       â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Trendyol SipariÅŸ          â”‚
        â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  INSERT INTO orders        â”‚
        â”‚                              â”‚  status='WAITING...'       â”‚
        â”‚                              â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          2. ATAMA AÅžAMASI                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Supabase DB                  Edge Function             Realtime Engine
        â”‚                              â”‚                            â”‚
        â”‚  New Order Event            â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  En YakÄ±n Kuryeyi Bul     â”‚
        â”‚                              â”‚  (Konum & Durum)          â”‚
        â”‚                              â”‚                            â”‚
        â”‚  UPDATE orders              â”‚                            â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
        â”‚  status='ASSIGNED'           â”‚                            â”‚
        â”‚  courier_id='...'            â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚  Change Detection            â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       3. BÄ°LDÄ°RÄ°M VE KABUL AÅžAMASI                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  Realtime Engine            Notification Service         Courier App
        â”‚                              â”‚                            â”‚
        â”‚  Yeni Atama                 â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Push Notification        â”‚
        â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  "Yeni sipariÅŸ!"          â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚              SipariÅŸi Kabul Et
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  UPDATE orders <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚                              â”‚  status='ACCEPTED'         â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      4. TESLÄ°MAT AÅžAMASI                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Courier App                  Supabase DB                 Merchant App
        â”‚                              â”‚                            â”‚
        â”‚  Konum GÃ¼ncelleme (30sn)    â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚  UPDATE location             â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Realtime Location â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  (CanlÄ± Harita)            â”‚
        â”‚                              â”‚                            â”‚
        â”‚  "Merchant'tan AldÄ±m"       â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚  status='PICKED_UP'          â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Status Update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚                            â”‚
        â”‚  "MÃ¼ÅŸteriye UlaÅŸtÄ±m"        â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚  status='ARRIVED'            â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚  "TESLÄ°M ETTÄ°M" ðŸŽ‰          â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚  status='DELIVERED'          â”‚                            â”‚
        â”‚                              â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    5. OTOMATÄ°K FÄ°NANSAL Ä°ÅžLEMLER ðŸ’°                          â”‚
â”‚                      (TRIGGER BASED - OTOMATIK!)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Supabase DB                    Trigger Function           Payment System
        â”‚                              â”‚                            â”‚
        â”‚  status='DELIVERED'         â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚  TRIGGER BAÅžLADI!         â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  1. Komisyon Config Al    â”‚
        â”‚  commission_configs <â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
        â”‚  rate=15%, fixed=2.0         â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  2. Hesapla:              â”‚
        â”‚                              â”‚     - SipariÅŸ: 100 TL     â”‚
        â”‚                              â”‚     - Komisyon: -17 TL    â”‚
        â”‚                              â”‚     - KDV: -3.06 TL       â”‚
        â”‚                              â”‚     - Merchant: 79.94 TL  â”‚
        â”‚                              â”‚     - Kurye: 20 TL        â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  3. Transaction OluÅŸtur   â”‚
        â”‚  payment_transactions <â”€â”€â”€â”€â”€â”€â”¤  (Merchant)               â”‚
        â”‚  INSERT                      â”‚                            â”‚
        â”‚    amount=79.94              â”‚                            â”‚
        â”‚    type='orderPayment'       â”‚                            â”‚
        â”‚    status='completed'        â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  4. Wallet GÃ¼ncelle       â”‚
        â”‚  merchant_wallets <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  (Merchant)               â”‚
        â”‚  UPDATE                      â”‚                            â”‚
        â”‚    balance += 79.94          â”‚                            â”‚
        â”‚    total_earnings += 79.94   â”‚                            â”‚
        â”‚    total_commissions += 17   â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  5. Transaction OluÅŸtur   â”‚
        â”‚  payment_transactions <â”€â”€â”€â”€â”€â”€â”¤  (Kurye)                  â”‚
        â”‚  INSERT                      â”‚                            â”‚
        â”‚    amount=20.0               â”‚                            â”‚
        â”‚    type='deliveryFee'        â”‚                            â”‚
        â”‚    status='completed'        â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  6. Wallet GÃ¼ncelle       â”‚
        â”‚  courier_wallets <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  (Kurye)                  â”‚
        â”‚  UPDATE                      â”‚                            â”‚
        â”‚    balance += 20.0           â”‚                            â”‚
        â”‚    total_deliveries += 1     â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  âœ… TAMAMLANDI!           â”‚
        â”‚  NOTICE LOG <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  "Ã–deme iÅŸlendi"          â”‚
        â”‚                              â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    6. REALTIME GÃœNCELLEME (Her Yerde)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Supabase DB              Realtime Engine         Merchant/Courier/Admin
        â”‚                              â”‚                            â”‚
        â”‚  Wallet deÄŸiÅŸti             â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Stream Update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  "Bakiye: 1,234.50 TL"    â”‚
        â”‚                              â”‚                            â”‚
        â”‚  Transaction eklendi        â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  Stream Update â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  "Yeni iÅŸlem: +79.94 TL"  â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       7. PARA Ã‡EKME Ä°ÅžLEMÄ°                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

   Merchant Panel               Supabase DB                Payment Service
        â”‚                              â”‚                            â”‚
        â”‚  "Para Ã‡ek" Butonu          â”‚                            â”‚
        â”‚  Miktar: 500 TL             â”‚                            â”‚
        â”‚  Banka: TR12...             â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  RPC: merchant_withdraw_money()
        â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚      1. Bakiye Kontrol    â”‚
        â”‚                              â”‚      available >= 500?    â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚      2. Transaction OluÅŸtur
        â”‚  payment_transactions <â”€â”€â”€â”€â”€â”€â”¤      type='withdrawal'    â”‚
        â”‚  INSERT                      â”‚      status='pending'     â”‚
        â”‚    amount=-500.0             â”‚      amount=-500.0        â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚      3. Bakiyeden DÃ¼ÅŸ     â”‚
        â”‚  merchant_wallets <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      balance -= 500       â”‚
        â”‚  UPDATE                      â”‚      total_withdrawals += 500
        â”‚                              â”‚                            â”‚
        â”‚  âœ… SUCCESS <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      Return: tx_id        â”‚
        â”‚                              â”‚                            â”‚
        â”‚  Bildirim                    â”‚                            â”‚
        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
        â”‚  "Para Ã§ekme talebiniz       â”‚                            â”‚
        â”‚   iÅŸleme alÄ±ndÄ±"             â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         8. RAPORLAMA SÄ°STEMÄ°                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Admin Panel                   Supabase Views            Report Generator
        â”‚                              â”‚                            â”‚
        â”‚  GÃ¼nlÃ¼k Rapor Iste          â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚  SELECT * FROM              â”‚                            â”‚
        â”‚  daily_merchant_earnings     â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚  SonuÃ§ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                            â”‚
        â”‚  - 234 sipariÅŸ              â”‚                            â”‚
        â”‚  - 18,567 TL ciro           â”‚                            â”‚
        â”‚  - 2,785 TL komisyon         â”‚                            â”‚
        â”‚  - 45 merchant aktif         â”‚                            â”‚
        â”‚  - 78 kurye Ã§alÄ±ÅŸtÄ±          â”‚                            â”‚

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      9. GÃœVENLÄ°K (RLS - Row Level Security)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    User Request                  RLS Policy Check          Database
        â”‚                              â”‚                            â”‚
        â”‚  SELECT * FROM              â”‚                            â”‚
        â”‚  payment_transactions        â”‚                            â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  auth.uid() = merchant_id? â”‚
        â”‚                              â”‚  OR role = 'admin'?       â”‚
        â”‚                              â”‚                            â”‚
        â”‚                              â”‚  âœ… AUTHORIZED            â”‚
        â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
        â”‚                              â”‚  Query Ã§alÄ±ÅŸtÄ±r           â”‚
        â”‚                              â”‚  WHERE merchant_id=...    â”‚
        â”‚                              â”‚                            â”‚
        â”‚  Sadece kendi kayÄ±tlarÄ± <â”€â”€â”€â”€â”¤                            â”‚
        â”‚  (Admin tÃ¼mÃ¼nÃ¼ gÃ¶rÃ¼r)        â”‚                            â”‚

```

---

## ðŸ”‘ Kritik Noktalar

### âš¡ Otomatik Tetikleme
- **Orders.status = 'DELIVERED'** olduÄŸu **anda** trigger Ã§alÄ±ÅŸÄ±r
- Manuel mÃ¼dahale **GEREKMEZ**
- Hata durumunda transaction **rollback** olur

### ðŸ’° Finansal GÃ¼venlik
- TÃ¼m hesaplamalar **server-side**
- Bakiye kontrolleri **atomik**
- Transaction'lar **ACID** garantili

### ðŸ“¡ Realtime Senkronizasyon
- Wallet deÄŸiÅŸiklikleri **anÄ±nda** yansÄ±r
- TÃ¼m paneller **aynÄ± anda** gÃ¼ncellenir
- WebSocket Ã¼zerinden **<100ms** gecikme

### ðŸ”’ GÃ¼venlik KatmanlarÄ±
1. **Authentication** (Supabase Auth)
2. **RLS Policies** (Database seviyesi)
3. **SECURITY DEFINER** (RPC fonksiyonlarÄ±)
4. **Check Constraints** (Balance >= 0)

---

## ðŸ“ˆ Performans Metrikleri

| Ä°ÅŸlem | SÃ¼re | AÃ§Ä±klama |
|-------|------|----------|
| SipariÅŸ OluÅŸturma | <50ms | INSERT + Edge Function |
| Otomatik Ã–deme | <200ms | Trigger + 4 UPDATE + 2 INSERT |
| Realtime GÃ¼ncelleme | <100ms | WebSocket broadcast |
| Para Ã‡ekme | <150ms | RPC + 2 UPDATE + 1 INSERT |
| Rapor Sorgusu | <500ms | View aggregation (30 gÃ¼n) |

---

## ðŸŽ¯ KullanÄ±cÄ± Perspektifleri

### ðŸ‘¨â€ðŸ’¼ Merchant
1. Kurye Ã§aÄŸÄ±rÄ±r
2. SipariÅŸ tamamlanÄ±r
3. **Otomatik** para kazanÄ±r ðŸ’°
4. Dashboard'da **anÄ±nda** bakiye artar
5. Ä°stediÄŸi zaman para Ã§ekebilir

### ðŸš´ Kurye
1. SipariÅŸ bildirimi alÄ±r
2. SipariÅŸi teslim eder
3. **Otomatik** teslimat Ã¼creti alÄ±r ðŸ’°
4. GÃ¼nlÃ¼k kazancÄ±nÄ± gÃ¶rÃ¼r
5. HaftalÄ±k para Ã§ekebilir

### ðŸ‘¨â€ðŸ’» Admin
1. TÃ¼m iÅŸlemleri **realtime** izler
2. Sistem komisyonlarÄ±nÄ± takip eder
3. Merchant/Kurye bakiyelerini gÃ¶rÃ¼r
4. RaporlarÄ± export eder
5. Para Ã§ekme taleplerini onaylar

---

**TÃ¼m sistem otomatik Ã§alÄ±ÅŸÄ±r. Tek yapmanÄ±z gereken Supabase'de SQL script'i Ã§alÄ±ÅŸtÄ±rmak!** ðŸš€
